<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IIJmio プラン比較シミュレーター</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & Babel CDNs -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        body {
            font-family: system-ui, -apple-system, sans-serif;
            line-height: 1.6;
            -webkit-tap-highlight-color: transparent;
        }
        /* キーボード操作時のフォーカスを強調 */
        :focus-visible {
            outline: 3px solid #be185d !important;
            outline-offset: 2px;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        const BASE_PLANS = [
            { id: 1, name: '2ギガ', gb: 2, price: 850, isLarge: false },
            { id: 2, name: '5ギガ', gb: 5, price: 950, isLarge: false },
            { id: 3, name: '10ギガ', gb: 10, price: 1400, isLarge: false },
            { id: 4, name: '15ギガ', gb: 15, price: 1800, isLarge: false },
            { id: 5, name: '25ギガ', gb: 25, price: 2000, isLarge: false },
            { id: 6, name: '35ギガ', gb: 35, price: 2400, isLarge: true },
            { id: 7, name: '45ギガ', gb: 45, price: 3300, isLarge: true },
            { id: 8, name: '55ギガ', gb: 55, price: 3900, isLarge: true },
        ];

        // アクセシビリティのため、アイコンはaria-hiddenにするか適切なラベルを付与
        const Icon = ({ name, className = "", ariaHidden = "true" }) => {
            const icons = {
                "check-circle": (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className} aria-hidden={ariaHidden}>
                        <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                        <polyline points="22 4 12 14.01 9 11.01"></polyline>
                    </svg>
                ),
                "trending-up": (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className} aria-hidden={ariaHidden}>
                        <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                        <polyline points="17 6 23 6 23 12"></polyline>
                    </svg>
                ),
                "trending-down": (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round" className={className} aria-hidden={ariaHidden}>
                        <polyline points="23 18 13.5 8.5 8.5 13.5 1 6"></polyline>
                        <polyline points="17 18 23 18 23 12"></polyline>
                    </svg>
                ),
                "arrow-right": (
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className} aria-hidden={ariaHidden}>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                        <polyline points="12 5 19 12 12 19"></polyline>
                    </svg>
                )
            };
            return icons[name] || null;
        };

        const App = () => {
            const [currentId, setCurrentId] = useState(1);
            const [hasFamilyDiscount, setHasFamilyDiscount] = useState(false);

            const plans = useMemo(() => {
                const discount = hasFamilyDiscount ? 100 : 0;
                return BASE_PLANS.map(p => ({
                    ...p,
                    price: p.price - discount
                }));
            }, [hasFamilyDiscount]);

            const currentPlan = useMemo(() => plans.find(p => p.id === currentId), [currentId, plans]);
            const currentPpg = currentPlan.price / currentPlan.gb;

            const formatCurrency = (val) => Math.round(val).toLocaleString();

            return (
                <main className="min-h-screen p-4 md:p-8">
                    <div className="max-w-5xl mx-auto space-y-8">

                        <header className="bg-white p-6 rounded-3xl shadow-md border border-slate-200">
                            <div className="flex flex-col md:flex-row md:items-center justify-between gap-6">
                                <div className="space-y-4">
                                    <div className="flex items-center gap-2">
                                        <h1 className="text-2xl font-black text-pink-800">IIJmio プラン比較</h1>
                                        <span className="bg-slate-800 text-white text-xs font-bold px-2 py-0.5 rounded uppercase">2026.01 更新</span>
                                    </div>

                                    <div className="flex flex-wrap gap-4">
                                        <button
                                            role="switch"
                                            aria-checked={hasFamilyDiscount}
                                            aria-label="複数回線割引を適用"
                                            onClick={() => setHasFamilyDiscount(!hasFamilyDiscount)}
                                            className="flex items-center gap-3 px-4 py-2 bg-slate-100 rounded-full border border-slate-300 hover:bg-white transition-colors focus-visible:ring-2 focus-visible:ring-pink-600"
                                        >
                                            <div className="relative pointer-events-none">
                                                <div className={`w-8 h-4 rounded-full transition-colors ${hasFamilyDiscount ? 'bg-pink-700' : 'bg-slate-400'}`}></div>
                                                <div className={`absolute top-0.5 left-0.5 bg-white w-3 h-3 rounded-full transition-transform ${hasFamilyDiscount ? 'translate-x-4' : ''}`}></div>
                                            </div>
                                            <span className="text-sm font-bold text-slate-800">複数回線割引 (-100円)</span>
                                        </button>
                                    </div>
                                </div>

                                <div className="bg-pink-50 p-5 rounded-2xl border-2 border-pink-200 w-full md:w-96 shadow-sm">
                                    <label htmlFor="plan-selector" className="block text-xs font-black text-pink-800 uppercase mb-2 tracking-widest">
                                        【現在の契約プランを選択】
                                    </label>
                                    <select
                                        id="plan-selector"
                                        value={currentId}
                                        onChange={(e) => setCurrentId(Number(e.target.value))}
                                        className="w-full bg-white text-lg font-black text-slate-900 border-slate-400 rounded-xl p-3 shadow-sm focus:ring-2 focus:ring-pink-700"
                                    >
                                        {plans.map(p => (
                                            <option key={p.id} value={p.id}>{p.name} ({formatCurrency(p.price)}円)</option>
                                        ))}
                                    </select>
                                    <div className="mt-4 flex justify-between items-center text-pink-900">
                                        <div className="text-xs font-bold leading-tight">
                                            基準：<span className="text-sm">{currentPlan.gb}GB</span><br/>
                                            月額：<span className="text-sm font-black">{formatCurrency(currentPlan.price)}円</span>
                                        </div>
                                        <div className="text-right">
                                            <p className="text-xs font-bold opacity-80">現在の1GB単価</p>
                                            <p className="text-2xl font-black">{formatCurrency(currentPpg)}<span className="text-sm ml-1">円</span></p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </header>

                        <section aria-label="全プラン比較一覧" className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                            {plans.map((target) => {
                                const isCurrent = target.id === currentId;
                                const gbDiff = target.gb - currentPlan.gb;
                                const priceDiff = target.price - currentPlan.price;
                                const targetPpg = target.price / target.gb;
                                const ppgChangePercent = ((targetPpg - currentPpg) / currentPpg) * 100;
                                const isEfficiencyBetter = targetPpg < currentPpg;

                                return (
                                    <article
                                        key={target.id}
                                        aria-current={isCurrent ? "true" : undefined}
                                        className={`bg-white rounded-[2rem] shadow-sm transition-all flex flex-col relative overflow-hidden group border-4 ${
                                            isCurrent ? 'border-pink-600 ring-8 ring-pink-100' : 'border-white hover:border-slate-300'
                                        }`}
                                    >
                                        {/* ヘッダー：総額の明示 */}
                                        <div className={`p-6 pb-4 ${isCurrent ? 'bg-pink-700 text-white' : 'bg-slate-900 text-white'}`}>
                                            <div className="flex justify-between items-start mb-2">
                                                <span className="text-xs font-black uppercase tracking-widest opacity-90">
                                                    {isCurrent ? '現在のプラン' : 'プラン変更後'}
                                                </span>
                                                {target.isLarge && (
                                                    <span className="text-xs font-black bg-white/20 px-2 py-0.5 rounded border border-white/30">大容量</span>
                                                )}
                                            </div>
                                            <h2 className="flex items-baseline gap-2 m-0 text-inherit">
                                                <span className="text-4xl font-black">{target.gb}</span>
                                                <span className="text-xl font-bold opacity-80">GB</span>
                                                <span className="ml-auto text-2xl font-black">{formatCurrency(target.price)}円</span>
                                            </h2>
                                        </div>

                                        <div className="p-6 space-y-6 flex-1 text-slate-900">
                                            {isCurrent ? (
                                                <div className="flex-1 flex flex-col items-center justify-center text-center py-8">
                                                    <div className="w-16 h-16 bg-pink-100 rounded-full flex items-center justify-center mb-4">
                                                        <Icon name="check-circle" className="text-pink-700 w-8 h-8" />
                                                    </div>
                                                    <p className="text-sm font-black text-pink-800">比較の基準点</p>
                                                    <p className="text-xs text-pink-700 mt-1 font-bold">他のカードと比較してください</p>
                                                </div>
                                            ) : (
                                                <>
                                                    <div className="space-y-4">
                                                        <h3 className="text-xs font-black text-slate-600 uppercase tracking-widest flex items-center gap-2">
                                                            <div className="w-1.5 h-3 bg-slate-400 rounded-full"></div>
                                                            現在との差分
                                                        </h3>

                                                        <div className="grid grid-cols-1 gap-2">
                                                            <div className="flex items-center justify-between p-3 bg-slate-50 rounded-2xl border border-slate-200">
                                                                <span className="text-sm font-bold text-slate-600">容量</span>
                                                                <div className="flex items-center gap-2">
                                                                    <span className="text-sm font-bold text-slate-500">{currentPlan.gb}</span>
                                                                    <Icon name="arrow-right" className="w-3 h-3 text-slate-400" />
                                                                    <span className="text-lg font-black">{target.gb}GB</span>
                                                                    <span className={`text-xs font-black px-2 py-0.5 rounded-full ${gbDiff > 0 ? 'bg-blue-100 text-blue-800' : 'bg-slate-200 text-slate-700'}`}>
                                                                        {gbDiff > 0 ? `+${gbDiff}` : gbDiff}GB
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <div className="flex items-center justify-between p-3 bg-slate-50 rounded-2xl border border-slate-200">
                                                                <span className="text-sm font-bold text-slate-600">料金</span>
                                                                <div className="flex items-center gap-2">
                                                                    <span className="text-sm font-bold text-slate-500">{formatCurrency(currentPlan.price)}</span>
                                                                    <Icon name="arrow-right" className="w-3 h-3 text-slate-400" />
                                                                    <span className="text-lg font-black">{formatCurrency(target.price)}円</span>
                                                                    <span className={`text-xs font-black px-2 py-0.5 rounded-full ${priceDiff > 0 ? 'bg-pink-100 text-pink-800 border border-pink-200' : 'bg-emerald-100 text-emerald-800 border border-emerald-200'}`}>
                                                                        {priceDiff > 0 ? `+${formatCurrency(priceDiff)}` : formatCurrency(priceDiff)}円
                                                                    </span>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div className="space-y-4 pt-2">
                                                        <h3 className="text-xs font-black text-slate-600 uppercase tracking-widest flex items-center gap-2">
                                                            <div className="w-1.5 h-3 bg-slate-400 rounded-full"></div>
                                                            1GBあたりのコスパ
                                                        </h3>
                                                        <div className={`p-4 rounded-2xl border-2 transition-colors ${isEfficiencyBetter ? 'bg-emerald-50 border-emerald-300' : 'bg-amber-50 border-amber-300'}`}>
                                                            <div className="flex justify-between items-center mb-1">
                                                                <span className="text-xs font-black text-slate-700">変更後の単価</span>
                                                                <div className={`text-xs font-black px-2 py-1 rounded-lg flex items-center gap-1 shadow-sm ${isEfficiencyBetter ? 'bg-emerald-700 text-white' : 'bg-amber-700 text-white'}`}>
                                                                    <Icon name={isEfficiencyBetter ? "trending-down" : "trending-up"} className="w-3 h-3" />
                                                                    {ppgChangePercent > 0 ? '単価アップ ' : '単価ダウン '}{Math.abs(ppgChangePercent).toFixed(1)}%
                                                                </div>
                                                            </div>
                                                            <p className="text-3xl font-black text-slate-900 leading-tight tracking-tight">
                                                                {formatCurrency(targetPpg)}<span className="text-sm font-bold text-slate-500 ml-1">円 / GB</span>
                                                            </p>
                                                        </div>
                                                    </div>
                                                </>
                                            )}

                                            <div className="pt-2">
                                                <div className="bg-slate-50 p-3 rounded-xl border border-slate-200 shadow-sm">
                                                    <p className="text-sm text-slate-700 font-medium leading-relaxed">
                                                        {isCurrent ? (
                                                            <span>基準となるプランです。</span>
                                                        ) : priceDiff > 0 ? (
                                                            <span>
                                                                月額が <span className="text-pink-800 font-bold">{formatCurrency(priceDiff)}円</span> 上がりますが、
                                                                増える分のギガは1GBあたり約<span className="text-slate-900 font-bold border-b-2 border-slate-400">{formatCurrency(priceDiff / gbDiff)}円</span>で手に入ります。
                                                            </span>
                                                        ) : (
                                                            <span>毎月 <span className="text-emerald-800 font-black">{formatCurrency(Math.abs(priceDiff))}円</span> の固定費を削減できます。</span>
                                                        )}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                    </article>
                                );
                            })}
                        </section>

                        <footer className="mt-12 py-10 border-t border-slate-300">
                            <div className="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-4xl mx-auto">
                                <div className="space-y-3">
                                    <h2 className="text-sm font-black text-slate-700 uppercase tracking-widest m-0">データの更新状況</h2>
                                    <p className="text-sm text-slate-600 leading-relaxed">
                                        IIJmio ギガプラン（音声SIM/eSIM）公式サイト料金<br />
                                        最終確認日: 2026年1月28日<br />
                                        ※35GB/45GB/55GBへの増量改定後データ。
                                    </p>
                                </div>
                                <div className="space-y-3">
                                    <h2 className="text-sm font-black text-slate-700 uppercase tracking-widest m-0">免責事項</h2>
                                    <p className="text-sm text-slate-600 leading-relaxed">
                                        複数回線割引（月額-100円）の適用条件は同一mioID内での契約数に依存します。実際の正確な料金は公式サイトをご確認ください。本ツールは個人による試算用です。
                                    </p>
                                </div>
                            </div>
                        </footer>
                    </div>
                </main>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
